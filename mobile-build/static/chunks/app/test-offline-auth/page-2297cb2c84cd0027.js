(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{78770:(e,s,t)=>{Promise.resolve().then(t.bind(t,94099))},94099:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var n=t(95155),r=t(12115),i=t(65523),a=t(86948),l=t(11647),c=t(47061),o=t(30218),d=t(42529),x=t(78874),h=t(52056),u=t(26983),m=t(3166),f=t(33738),j=t(17910),g=t(20508),N=t(89559);function y(){var e,s;let{user:t,session:y,profile:p,loading:w,isOnline:v}=(0,c.A)(),[b,S]=(0,r.useState)({isOnline:!0,lastOnlineTime:Date.now(),connectionType:void 0}),[A,T]=(0,r.useState)(null),[k,O]=(0,r.useState)([]);(0,r.useEffect)(()=>{let e=o.t.addConnectionListener(e=>{S(e)});return(async()=>{T(await o.t.getOfflineAuthState())})(),e},[]);let E=(e,s,t)=>{O(n=>[...n,{test:e,status:s,message:t,timestamp:Date.now()}])},C=async()=>{O([]),E("Offline Auth State","pending","Checking offline auth state...");try{let s=await o.t.getOfflineAuthState();if(s){var e;E("Offline Auth State","success","Found offline state for user: ".concat((null==(e=s.user)?void 0:e.email)||"Unknown"))}else E("Offline Auth State","warning","No offline auth state found")}catch(e){E("Offline Auth State","error","Error: ".concat(e))}E("Network Error Handling","pending","Testing network error handling...");try{await o.t.handleAuthError(Error("Failed to fetch"))?E("Network Error Handling","success","Network error handled correctly"):E("Network Error Handling","warning","Network error not handled")}catch(e){E("Network Error Handling","error","Error: ".concat(e))}E("Retry Queue","pending","Testing retry queue functionality...");try{await o.t.queueRetryAction(async()=>{console.log("Test retry action executed")}),E("Retry Queue","success","Retry action queued successfully")}catch(e){E("Retry Queue","error","Error: ".concat(e))}E("Connection Waiting","pending","Testing connection waiting...");try{let e=await o.t.waitForConnection(1e3);E("Connection Waiting",e?"success":"warning",e?"Connection available":"Connection timeout (expected if offline)")}catch(e){E("Connection Waiting","error","Error: ".concat(e))}},R=async()=>{try{await o.t.clearOfflineAuthState(),T(null),E("Clear Offline State","success","Offline auth state cleared")}catch(e){E("Clear Offline State","error","Error: ".concat(e))}};return(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-100 p-4",children:(0,n.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Offline Authentication Test"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Test and verify offline authentication functionality"})]}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsxs)(a.ZB,{className:"flex items-center space-x-2",children:[v?(0,n.jsx)(m.A,{className:"h-5 w-5 text-green-600"}):(0,n.jsx)(f.A,{className:"h-5 w-5 text-red-600"}),(0,n.jsx)("span",{children:"Network Status"})]})}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(l.E,{variant:v?"default":"destructive",children:v?"Online":"Offline"}),(0,n.jsx)("span",{className:"text-sm text-gray-600",children:v?"Connected":"Disconnected"})]}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,n.jsx)("strong",{children:"Last Online:"})," ",new Date(b.lastOnlineTime).toLocaleTimeString()]}),(0,n.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,n.jsx)("strong",{children:"Connection Type:"})," ",b.connectionType||"Unknown"]})]})})]}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsxs)(a.ZB,{className:"flex items-center space-x-2",children:[(0,n.jsx)(j.A,{className:"h-5 w-5 text-blue-600"}),(0,n.jsx)("span",{children:"Authentication Status"})]})}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2",children:"Current Session"}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(g.A,{className:"h-4 w-4"}),(0,n.jsx)("span",{children:t?"".concat(t.email," (").concat(t.id,")"):"Not authenticated"})]}),(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)(l.E,{variant:y?"default":"secondary",children:y?"Active Session":"No Session"})}),(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)(l.E,{variant:p?"default":"secondary",children:p?"".concat(p.role," Profile"):"No Profile"})})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2",children:"Offline State"}),(0,n.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Stored:"})," ",A?"Yes":"No"]}),A&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"User:"})," ",(null==(e=A.user)?void 0:e.email)||"Unknown"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Last Sync:"})," ",new Date(A.lastSyncTime).toLocaleString()]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("strong",{children:"Pending Actions:"})," ",(null==(s=A.pendingActions)?void 0:s.length)||0]})]})]})]})]})})]}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:"Test Controls"}),(0,n.jsx)(a.BT,{children:"Run tests to verify offline authentication functionality"})]}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,n.jsxs)(i.$n,{onClick:C,disabled:w,children:[(0,n.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Run Tests"]}),(0,n.jsx)(i.$n,{onClick:R,variant:"outline",children:"Clear Offline State"})]})})]}),k.length>0&&(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{children:"Test Results"})}),(0,n.jsx)(a.Wu,{children:(0,n.jsx)("div",{className:"space-y-3",children:k.map((e,s)=>(0,n.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border",children:[(e=>{switch(e){case"success":return(0,n.jsx)(d.A,{className:"h-4 w-4 text-green-600"});case"error":return(0,n.jsx)(x.A,{className:"h-4 w-4 text-red-600"});case"warning":return(0,n.jsx)(h.A,{className:"h-4 w-4 text-yellow-600"});default:return(0,n.jsx)(u.A,{className:"h-4 w-4 text-blue-600"})}})(e.status),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,n.jsx)("span",{className:"font-medium",children:e.test}),(0,n.jsx)(l.E,{className:(e=>{switch(e){case"success":return"bg-green-100 text-green-800";case"error":return"bg-red-100 text-red-800";case"warning":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}})(e.status),children:e.status})]}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:e.message}),(0,n.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]})]},s))})})]}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{children:"Testing Instructions"})}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"space-y-4 text-sm",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2",children:"To test offline functionality:"}),(0,n.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-gray-600",children:[(0,n.jsx)("li",{children:"Make sure you're logged in and have an active session"}),(0,n.jsx)("li",{children:"Turn off your internet connection (or use browser dev tools)"}),(0,n.jsx)("li",{children:"Refresh the page - you should still see your authentication status"}),(0,n.jsx)("li",{children:"Turn your internet back on"}),(0,n.jsx)("li",{children:"Run the tests to verify offline state management"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-semibold mb-2",children:"Expected behavior:"}),(0,n.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[(0,n.jsx)("li",{children:"Authentication state should persist when offline"}),(0,n.jsx)("li",{children:"No network errors should appear in console when offline"}),(0,n.jsx)("li",{children:"Session should be restored when connection returns"}),(0,n.jsx)("li",{children:"Retry actions should be queued and executed when online"})]})]})]})})]})]})})}}},e=>{e.O(0,[8096,6332,7061,6867,5523,8441,7358],()=>e(e.s=78770)),_N_E=e.O()}]);